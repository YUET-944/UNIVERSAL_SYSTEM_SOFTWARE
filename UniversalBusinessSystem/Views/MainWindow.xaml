<Window x:Class="UniversalBusinessSystem.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Universal Business System" 
        Height="800" Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource MaterialDesignPaper}">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <materialDesign:ColorZone Grid.Row="0" 
                                 Mode="PrimaryMid" 
                                 Padding="16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Logo and Title -->
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="Store" 
                                           Width="32" Height="32" 
                                           VerticalAlignment="Center"
                                           Margin="0,0,10,0"/>
                    <TextBlock Text="Universal Business System" 
                              FontSize="20" FontWeight="SemiBold"
                              VerticalAlignment="Center"/>
                </StackPanel>

                <!-- User Info -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="{Binding CurrentUser.FullName}" 
                              Margin="0,0,16,0"
                              VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding CurrentOrganization.Name}" 
                              Margin="0,0,16,0"
                              Opacity="0.8"
                              VerticalAlignment="Center"/>
                    <Button Style="{StaticResource MaterialDesignIconButton}"
                           Command="{Binding LogoutCommand}">
                        <materialDesign:PackIcon Kind="Logout"/>
                    </Button>
                </StackPanel>
            </Grid>
        </materialDesign:ColorZone>

        <!-- Main Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Navigation Sidebar -->
            <materialDesign:ColorZone Grid.Column="0" 
                                     Mode="Light" 
                                     Padding="16"
                                     materialDesign:ShadowAssist.ShadowDepth="Depth1">
                <ScrollViewer>
                    <StackPanel>
                        <TextBlock Text="Modules" 
                                  FontSize="16" FontWeight="SemiBold"
                                  Margin="0,0,0,16"/>

                        <!-- Module List -->
                        <ItemsControl ItemsSource="{Binding ModuleNavigationItems}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Button Style="{StaticResource MaterialDesignFlatButton}"
                                           HorizontalAlignment="Stretch"
                                           HorizontalContentAlignment="Left"
                                            Margin="0,2"
                                           Command="{Binding DataContext.NavigateToModuleCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                           CommandParameter="{Binding Key}">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="{Binding Icon}" 
                                                                   Width="20" Height="20"
                                                                   Margin="0,0,12,0"/>
                                            <TextBlock Text="{Binding Name}"/>
                                        </StackPanel>
                                    </Button>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <!-- Module Management -->
                        <Separator Margin="0,16"/>
                        <Button Style="{StaticResource MaterialDesignFlatButton}"
                               HorizontalAlignment="Stretch"
                               HorizontalContentAlignment="Left"
                               Margin="0,2"
                               Command="{Binding NavigateToModuleManagementCommand}">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Settings" 
                                                       Width="20" Height="20"
                                                       Margin="0,0,12,0"/>
                                <TextBlock Text="Module Management"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </ScrollViewer>
            </materialDesign:ColorZone>

            <!-- Content Area -->
            <Grid Grid.Column="1" Margin="16">
                <ContentControl Content="{Binding CurrentContent}"/>
            </Grid>
        </Grid>

        <!-- Status Bar -->
        <materialDesign:ColorZone Grid.Row="2" 
                                 Mode="PrimaryDark" 
                                 Padding="16,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" 
                          Text="{Binding StatusMessage}"
                          VerticalAlignment="Center"/>

                <TextBlock Grid.Column="1" 
                          Text="{Binding CurrentTime, StringFormat='yyyy-MM-dd HH:mm:ss'}"
                          VerticalAlignment="Center"/>
            </Grid>
        </materialDesign:ColorZone>
    </Grid>
</Window>
